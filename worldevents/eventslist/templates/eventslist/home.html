{% extends "eventslist/base.html" %}
{% load staticfiles %}
{% block javascript %}
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" ></script>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script type="text/javascript" src={% static "javascript/gmap3.min.js" %}></script>

{% endblock %}
{% block content %}
<div>
		
	{% if user.is_authenticated %}	
			{{user.username}}
			<a href="{% url 'eventslist.views.logoutpage' %}">Logout</a>
		
	{% else %}
		<a href="{% url 'eventslist.views.register' %}">Registro</a>
		<a href="{% url 'eventslist.views.loginpage' %}">Login</a>
			
	{% endif %}
	{% if user.is_authenticated %}
		<a href="{% url 'eventslist.views.addevent' %}">Add Event</a>
	{% endif %}
	</div>
	
	{% if nearby_list %}	
		<table>
		{% for event in nearby_list%}
			<tr>
				<td>{{ event.title }}</td>
				<td>{{ event.description }}</td>
				<td>{{ event.category }}</td>
			</tr>
		{% endfor %}
		</table>
	{% endif %}

	<div>
	  {% if form %}
	  <form action="" method="post">
	      {{ form.as_p }}
              <p>Select location in the map</p>
              <div id="Location">Location:</div>
              <div id="my_map"></div>
	      {% csrf_token %} 
	      <input type="submit" value="search">
	  </form>
  	{% endif %}
	</div>

{% endblock %}
{% block scripts %}
 <script type="text/javascript">
	$( document ).ready(function() {
                $("#my_map").width("300px").height("150px").gmap3({
          map:{
            options:{
              center:[46.578498,2.457275],
              zoom: 3
            },
            events:{
              click: function(map,event){
                $("#Location").text("Location: Lat: "+event.latLng.lat()+" Lon: "+event.latLng.lng());
		$("#id_lat").val(event.latLng.lat());
		$("#id_lng").val(event.latLng.lng());
              }
            }
          }
        });
	});

</script>
{% endblock %}

